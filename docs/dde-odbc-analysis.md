# Точки интеграции с QUIK (DDE/ODBC)

## Источники рыночных данных
- Лист `quotes` содержит потоковую таблицу с колонками `Оборот`, `Цена послед.`, `Спрос`, `Предл.` и служебный `HeartBeat`; в строках видны инструменты с кодировкой QUIK (`BRX4 [FORTS: Фьючерсы]`, `GDZ4 [FORTS: Фьючерсы]` и т.д.).
- Листы `gold`, `mxi`, `br`, `si` хранят свечные ряды (`Дата`, `Время`, `Цена открытия`, `Максимальная цена`, `Минимальная цена`, `Цена закрытия`) для соответствующих инструментов и таймфреймов, что указывает на агрегирование входящих котировок.
- В файле `robot.xlsb` формулы/подключения не видны через `pyxlsb`, значения в ячейках уже подставлены. Это косвенно указывает на внешний источник (DDE/ODBC), который записывает котировки и heartbeat прямо в таблицу.

## Заявки и сделки
- Лист `orders` повторяет структуру журнала QUIK: `Номер`, `Выставлена (время)`, `Код инструмента`, `Операция`, `Счет`, `Цена`, `Кол-во`, `Остаток`, `Объем`, `Комментарий`, `Состояние`.
- Лист `deals` аналогично содержит стандартные поля сделок (`Номер`, `Время`, `Заявка`, `Код инструмента`, `Операция`, `Счет`, `Цена`, `Кол-во`, `Комментарий`, `Объем`, `Комиссия ТС`).
- В колонке `Комментарий` фиксируются служебные коды заявок вида `o-RS7_120-4-18-45` / `c-AR6_15-0.1-1.1-1.4`, что использует VBA-логика для сопоставления сделок со стратегиями.

## Конфигурация стратегий
- Лист `strategies` хранит параметры подключения к инструментам: `Sheet`, `SecCode`, `TimeFrame`, `delta(k)`, `sl`, `tp`, `slip`, `Qty`, `Pos`, а также последние значения `Max/Min/Avg`, направление (`Direction`) и входную цену (`EnterPrice`).
- Поля `SecCode` и `Sheet` задают связь между стратегией и листами котировок/свечей, которые заполняются из QUIK.

## Оставшиеся вопросы
- В бинарных листах/модулях не обнаружены явные строки с каналами/топиками DDE, потому что VBA коды сжаты (`vbaProject.bin`). Требуется извлечение модулей (`olevba`/`vbac`), чтобы увидеть функции `DDEInitiate`/`DDEPoke` или ODBC-подключения и конкретные имена топиков.
- Не зафиксировано, как инициируется запись в листы `quotes` и OHLC-листы — вероятно, через макросы с периодическим опросом QUIK и обновлением таблиц.
