# План анализа торгового робота (QUIK DDE, robot.xlsb)

## Прогресс (чекбоксы)
- [x] Инвентаризация распакованной структуры (листовые данные, модули по маркерам, сводка в `docs/research-summary.md`).
- [x] Извлечение VBA-кода из `xl/vbaProject.bin` в текст `.bas/.cls/.frm` (нужно средство `olevba/vbac`).
- [x] Поиск точек интеграции QUIK DDE/ODBC (каналы, топики, DDE-ссылки в листах).
- [ ] Обзор бизнес-логики (сигналы, заявки, риск, параметры стратегий).
- [ ] Финальная фиксация выводов и вопросов.

## Основные шаги
1. Инвентаризация структуры
   - Обойти `robot-analyze/xl`: листы (`worksheets/`), строки (`sharedStrings.bin`), стили, `vbaProject.bin`.
   - Зафиксировать названия листов, именованные диапазоны, вспомогательные файлы.
2. Извлечение VBA-кода
   - Распаковать `xl/vbaProject.bin` в `.bas/.cls/.frm` (использовать `oledump/olevba` или vbac).
   - Сохранить структуру модулей, классов и форм; отметить зависимости/референсы.
3. Точки интеграции с QUIK DDE/ODBC
   - Найти создание каналов/топиков, таблицы QUIK (котировки, стакан, сделки).
   - В листах выявить DDE-ссылки, диапазоны входящих данных и ячейки исходящих заявок.
4. Обзор бизнес-логики
   - Определить вычисление сигналов: правила входа/выхода, фильтры, параметры (таймфреймы, лимиты).
   - Проследить формирование заявок и риск-контроль (лоты, стопы, блокировки после ошибок).
   - Зафиксировать конфигурационные ячейки/настройки и связи между листами.
5. Фиксация находок и вопросы
   - Составить отчёт по структуре/логике, отметить риски и технический долг.
   - Выписать вопросы по неочевидным параметрам и предложения по тестированию.

## Параллельно (можно делать независимо)
- Извлечение VBA (при появлении инструмента) и анализ листов/данных.
- Сопоставление истории `orders/deals` с ценами `gold/mxi/br/si` для реконструкции правил вход/выход.
- Проверка DDE/ODBC-ссылок в листах и актуальности имён стратегий/кодовых комментариев (`o-...`, `c-...`).
